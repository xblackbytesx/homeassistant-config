- id: toilet_001
  alias: toilet_001
  trigger:
    - platform: state
      entity_id: binary_sensor.toilet_motion_detected
      to: 'on'
    - platform: state
      entity_id: binary_sensor.toilet_motion_detected
      to: 'off'
      for:
        minutes: "{{ states('input_number.toilet_motion_timeout')| int }}"
  action:
    service_template: >
      {% if trigger.to_state.state == 'on' %}
        scene.turn_on
      {% elif trigger.to_state.state == 'off' %}
        light.turn_off
      {% endif %}
    data_template:
      entity_id: >
        {% if trigger.to_state.state == 'on' %}
          {% if is_state('input_boolean.time_for_dim_scenes', 'on') %}
            scene.toilet_night
          {% else %}
            scene.toilet_day
          {% endif %}
        {% elif trigger.to_state.state == 'off' %}
          light.lg_toilet_all
        {% endif %}
